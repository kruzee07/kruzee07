name: Daily Commit

on:
  schedule:
    - cron: '0 0 * * *'  # Runs daily at midnight UTC
  workflow_dispatch:  # Allows manual trigger

permissions:
  contents: write  # Grant write permissions to push changes

jobs:
  commit:
    runs-on: ubuntu-latest

    steps:
    # Step 1: Checkout the repository
    - name: Checkout repository
      uses: actions/checkout@v3

    # Step 2: Make a dynamic change to a file
    - name: Modify a file
      run: |
        # Generate a random number
        RANDOM_NUMBER=$((RANDOM % 1000))
        # Get the current timestamp in Eastern Time (with EST/EDT based on daylight savings) 
        TIMESTAMP=$(TZ="America/New_York" date +"%Y-%m-%d %H:%M:%S %Z")
        # Create a unique daily message
        COMMIT_MESSAGE="Commit made at $TIMESTAMP with random number: $RANDOM_NUMBER"
        # Make sure the message is not empty
        echo "$COMMIT_MESSAGE" >> auto_commit_log.txt

    # Step 3: Configure Git and commit
    - name: Commit changes
      run: |
        git config --global user.name "GitHub Actions Bot"
        git config --global user.email "actions@github.com"
        git add auto_commit_log.txt
        # Ensure COMMIT_MESSAGE is not empty
        git commit -m "${COMMIT_MESSAGE:-'Default commit message'}"
        git push
